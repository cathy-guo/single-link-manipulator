function U = feedforward(ref, I_beam, Kp, Kd, X, C_hat)
% Returns the control input for a feedforward + PD feedback control scheme

    rho_curr = [Kp*C_hat, Kd*C_hat]*X;
    
    U = I_beam*ref.theta_dd - rho_curr - Kd*(rho_dot_mu - rho_dot_d);
end